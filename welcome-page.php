<?phpinclude 'header.php';include 'check_session.php';if (!isset($_GET['ques_id'])) {    echo '<h1>Invalid Access !!</h1>';    echo '<script>location.href = "admin.php";</script>';    exit();} else {    include "./API/include/Connection.class.php";    include "./API/include/Quest.class.php";    $questObj = new Quest();    $ques_id = $_GET['ques_id'];    $bool = $questObj->isValidQuesID($ques_id);    if ($bool) {        echo '<h1>Invalid Question ID passed !!</h1>';        exit();    }    $welcome_checked = "checked";    $runEffect = "";    $header_image_attach = "";    $header_image_hidden = "display: none;";    $re_title_name = "";    $re_title_font = "Select Font";    $re_title_size = "Select Size";    $re_title_type = "";    $re_title_color = "orangered";    $re_text_name = "";    $re_text_font = "Select Font";    $re_text_size = "Select Size";    $re_text_type = "";    $re_text_color = "orangered";    $re_bg_image_attach = "";    $re_bg_image_hidden = "display: none;";    $re_bg_color = "orangered";    $re_button_name = "";    $re_button_size = "";    $re_button_color = "orangered";    $re_button_active = "";    $re_tap_active = "";    if (isset($_POST['submitted'])) {        $is_welcome = isset($_POST['iswelcome']) ? "0" : "1";        $setting_id = 3;        $insertSettingBool = $questObj->checkQuesSetting($ques_id, $setting_id);        if ($insertSettingBool) {            $questObj->insertQuesSetting($ques_id, $setting_id, $is_welcome);        } else {            $questObj->updateQuesSetting($ques_id, $setting_id, $is_welcome);        }        if ($is_welcome == "1") {            $header_image = isset($_FILES['headerimage']) ? $_FILES['headerimage'] : array();            $ques_title = isset($_POST['ques_title']) ? $_POST['ques_title'] : "";            $title_size = isset($_POST['title_size_hidden']) ? $_POST['title_size_hidden'] : "";            $title_font = isset($_POST['title_font_hidden']) ? $_POST['title_font_hidden'] : "";            $title_color = isset($_POST['title_color']) ? $_POST['title_color'] : "";            $ques_text = isset($_POST['ques_text']) ? $_POST['ques_text'] : "";            $text_size = isset($_POST['text_size']) ? $_POST['text_size'] : "";            $text_font = isset($_POST['text_font']) ? $_POST['text_font'] : "";            $text_color = isset($_POST['text_color']) ? $_POST['text_color'] : "";            $background_image = isset($_FILES['bgimage']) ? $_FILES['bgimage'] : array();            $bg_color = isset($_POST['bgcolor']) ? $_POST['bgcolor'] : "";            $btn_text = isset($_POST['btn_text']) ? $_POST['btn_text'] : "";            $btn_size = isset($_POST['btn_size']) ? $_POST['btn_size'] : "";            $btn_color = isset($_POST['btn_color']) ? $_POST['btn_color'] : "";            $btn_switch = isset($_POST['btn_switch']) ? "1" : "0";            $tap_switch = isset($_POST['tap_switch']) ? "1" : "0";            $element_type = array();            $element_type[] = 'Header Image';            $element_type[] = 'Title';            $element_type[] = 'Text';            $element_type[] = 'Background Image';            $element_type[] = 'Button';            $element_type[] = 'Tap';            $element_name = array();            $element_name[] = '';            $element_name[] = $ques_title;            $element_name[] = $ques_text;            $element_name[] = '';            $element_name[] = $btn_text;            $element_name[] = '';            $element_size = array();            $element_size[] = '';            $element_size[] = $title_size;            $element_size[] = $text_size;            $element_size[] = '';            $element_size[] = $btn_size;            $element_size[] = '';            $element_font = array();            $element_font[] = '';            $element_font[] = $title_font;            $element_font[] = $text_font;            $element_font[] = '';            $element_font[] = '';            $element_font[] = '';            $element_color = array();            $element_color[] = '';            $element_color[] = $title_color;            $element_color[] = $text_color;            $element_color[] = $bg_color;            $element_color[] = $btn_color;            $element_color[] = '';            $element_attachment = array();            $element_attachment[] = $header_image;            $element_attachment[] = '';            $element_attachment[] = '';            $element_attachment[] = $background_image;            $element_attachment[] = '';            $element_attachment[] = '';            $active = array();            $active[] = '1';            $active[] = '1';            $active[] = '1';            $active[] = '1';            $active[] = $btn_switch;            $active[] = $tap_switch;            $count = count($element_type);            $access_token = $_SESSION['access_token'];            $insertElementBool = $questObj->checkQuesSettingElement($ques_id, $setting_id);            for ($i = 0; $i < $count; $i++) {                if ($element_attachment[$i] != '') {                    $file_name = $questObj->uploadFile($element_attachment[$i], $access_token);                } else {                    $file_name = '';                }                if ($insertElementBool) {                    $questObj->insertQuesElement($ques_id, $setting_id, $element_type[$i], $element_name[$i], $element_color[$i], $element_size[$i], $element_font[$i], $file_name, $active[$i]);                } else {                    $questObj->updateQuesElement($ques_id, $setting_id, $element_type[$i], $element_name[$i], $element_color[$i], $element_size[$i], $element_font[$i], $file_name, $active[$i]);                }            }        }        echo "<script>location.href = 'questionnaire_question.php?ques_id=$ques_id'; </script>";        exit();    } else {        $welcome_check = $questObj->isWelcome($ques_id);        if ($welcome_check) {            $welcome_checked = "";            $runEffect = "runEffect();";        } else {            $welcome_checked = "checked";        }        $elements = $questObj->getQuesSettingElement($ques_id, array(3));        foreach ($elements as $element) {            if ($element['element_type'] == "Header Image") {                if(trim($element['element_attachment']) != "") {                    $header_image_attach = "images/".$element['element_attachment'];                    $header_image_hidden = "";                }            } else if ($element['element_type'] == "Title") {                $re_title_name = $element['element_name'];                $re_title_size = $element['element_size'];                $re_title_font = $element['element_font'];                $re_title_color = $element['element_color'];            } else if ($element['element_type'] == "Text") {                $re_text_name = $element['element_name'];                $re_text_size = $element['element_size'];                $re_text_font = $element['element_font'];                $re_text_color = $element['element_color'];            } else if ($element['element_type'] == "Background Image") {                $re_bg_image_attach = "images/".$element['element_attachment'];                $re_bg_image_hidden = "";                $re_bg_color = $element['element_color'];            } else if ($element['element_type'] == "Button") {                $re_button_name = $element['element_name'];                $re_button_size = $element['element_size'];                $re_button_color = $element['element_color'];                $re_button_active = ($element['active'] == "1") ? "checked" : "";            } else if ($element['element_type'] == "Tap") {                $re_tap_active = ($element['active'] == "1") ? "checked" : "";            }        }    }}?><script>    function readURL(input) {        if (input.files && input.files[0]) {            var reader = new FileReader();            reader.onload = function(e) {                $(input).closest("div").find('#dispimg').attr('src', e.target.result);                $(input).closest("div").find('#dispimg').show();            };            reader.readAsDataURL(input.files[0]);        }    }    function save(check)    {        var title_size = $('#title_size').html();        $('#title_size_hidden').val(title_size);        var title_font = $("#title_font").html();        $('#title_font_hidden').val(title_font);    }    $(document).ready(function() {<?php echo $runEffect; ?>        $("#headerbutt").click(function() {            $("#headerimage").click();        });        $("#bgimagebutt").click(function() {            $("#bgimage").click();            event.preventDefault();        });        $("#headerimage").change(function() {            readURL(this);        });        $("#bgimage").change(function() {            readURL(this);        });        $('#saveandnext').click(function(event) {            event.preventDefault();            save("san");            $("#form").submit();        });    });</script><div class="sec_create">    <h2 class="sec_head_ques"> Create a Questionnaire</h2></div><section>    <div class="wrapper">        <form action="#" id="form" method="post" enctype="multipart/form-data">            <div class="container ww">                <h2 class="wel_head"> Would you like a Welcome page</h2>                <div class="onoffswitch">                    <input type="checkbox" name="iswelcome" class="onoffswitch-checkbox" id="taber" <?php echo $welcome_checked; ?>>                    <label class="onoffswitch-label" for="taber"> <span class="onoffswitch-inner"></span> <span class="onoffswitch-switch"></span> </label>                </div>                <div class="show_toggle">                    <div class="hide_toggle">                        <div class="header_browse">                            <!--<div class="browse">-->                            <div>                                <div class="photo_head">                                    <h3> Header Photo </h3>                                </div>                                <div class="button_browse">                                    <button class="bb_ques" id="headerbutt" type="button">Browse</button>                                    <input type="file" id="headerimage" name="headerimage" style="display:none;"/>                                    <img id="dispimg" src="<?php echo $header_image_attach; ?>" alt="Header Image" style="<?php $header_image_hidden; ?>; /*max-height: 200px;*/ max-width: 200px; margin-top: 10px;"/>                                </div>                            </div>                            <div class="outer_title1">                                <div class="inner_title1 fleft">                                    <label>Title</label>                                    <br>                                    <input type="text" name="ques_title" value="<?php echo $re_title_name; ?>" id="ques_title" class="title_text title_text1">                                </div>                                <div class="inner_title1 fleft ">                                    <label>Title Size</label>                                    <br>                                    <div class="wrapper-demo">                                        <div id="dd" class="wrapper-dropdown-3" tabindex="1"> <span id="title_size"><?php echo $re_title_size; ?></span>                                            <input type="hidden" name="title_size_hidden" id="title_size_hidden" />                                            <ul class="dropdown">                                                <?php for ($size = 10; $size < 30; $size++) { ?>                                                    <li><a href="#"><?php echo $size; ?></a></li>                                                <?php } ?>                                                            </ul>                                        </div>                                        ​</div>                                </div>                                <div class="inner_title1 fleft">                                    <label>Title Font</label>                                    <br>                                    <div class="wrapper-demo">                                        <div id="dd1" class="wrapper-dropdown-3" tabindex="1"> <span id="title_font"><?php echo $re_title_font; ?></span>                                            <input type="hidden" name="title_font_hidden" id="title_font_hidden" />                                            <?php $font_array = ["Arial", "Times New Roman", "Sans-Serif"]; ?>                                            <ul class="dropdown">                                                <?php                                                foreach ($font_array as $font) {                                                    ?>                                                    <li><a href="#"><?php echo $font; ?></a></li>                                                    <?php                                                }                                                ?>                                            </ul>                                        </div>                                        ​</div>                                </div>                                <div class="inner_title1 fleft">                                    <label>Title Color</label>                                    <br>                                    <div class='example'>                                        <input type='text' name='title_color' id='13' value='<?php echo $re_title_color; ?>' />                                                      </div>                                </div>                            </div>                            <div class="clear"> </div>                            <div class="outer_title1">                                <div class="inner_title1 fleft">                                    <label>Text</label>                                    <br>                                    <textarea rows="5" cols="25" id="ques_text" name="ques_text" ><?php echo $re_text_name; ?></textarea>                                </div>                                <div class="inner_title1 fleft ">                                    <label>Text Size</label>                                    <br>                                    <input type="number" id="text_size" value="<?php echo $re_text_size; ?>" name="text_size" class="title_size title_size1">                                </div>                                <div class="inner_title1 fleft">                                    <label>Text Font</label>                                    <br>                                    <input type="text" id="text_font" name="text_font" value="<?php echo $re_text_font; ?>" class="title_size title_size_font title_size1">                                </div>                                <div class="inner_title1 fleft">                                    <label>Text Color</label>                                    <br>                                    <div class='example'>                                        <input type='text' name='text_color' id='14' value='<?php echo $re_text_color; ?>' />                                    </div>                                </div>                            </div>                            <div class="clear"> </div>                        </div>                        <div class="outer_title1" >                            <div class="inner_title3 inner_title_ttl  fleft" style="height: auto;">                                <label class="sec_head_ques1 "> Background-image </label>                                <div class="sec_ques_div" style="height: auto;">                                    <button class="bb_ques fleft" id="bgimagebutt">Browse..</button>                                    <input type="file" name="bgimage" id="bgimage" style="display:none;"/>                                    <img id="dispimg" src="<?php echo $re_bg_image_attach; ?>" alt="Header Image" style="<?php echo $re_bg_image_hidden; ?>; /*max-height: 200px;*/ max-width: 200px; margin-top: 40px;"/>                                </div>                            </div>                            <div class="inner_title3 inner_title_ttl fleft ">                                <label>Background-color</label>                                <br>                                <div class='example'>                                    <input type='text' name='bgcolor' id='15' value='<?php echo $re_bg_color; ?>' />                                </div>                            </div>                        </div>                        <div class="clear"> </div>                        <div class="outer_sec5">                            <div class="outer_title1">                                <div class="inner_title1 fleft">                                    <label> Button Text</label>                                    <br>                                    <input id="btn_text" value="<?php echo $re_button_name; ?>" name="btn_text" type="text">                                </div>                                <div class="inner_title3 fleft ">                                    <label>Button-color</label>                                    <br>                                    <div class='example'>                                        <input type='text' name='btn_color' value="<?php echo $re_button_color; ?>" id='16' />                                    </div>                                </div>                                <div class="inner_title1 fleft ">                                    <label>Button Size</label>                                    <br>                                    <input type="number" id="btn_size" name="btn_size" value="<?php echo $re_button_size; ?>" class="title_size title_size1">                                </div>                                <div class="fleft">                                    <label>Show/Hide Button</label>                                    <br>                                    <div class="onoffswitch1">                                        <input type="checkbox" name="btn_switch" class="onoffswitch-checkbox" id="tab2" <?php echo $re_button_active; ?>>                                        <label class="onoffswitch-label" for="tab2">                                            <span class="onoffswitch-inner onoffswitch-inner1"></span> <span class="onoffswitch-switch onoffswitch-switch1"></span></label>                                    </div>                                    <!--label class=" fright"> Show</label-->                                </div>                            </div>                            <div class="clear"> </div>                        </div>                        <div class="wel_lastpara"> <span class="wel_lastpara_span">Tap anywhere on screen to enter questionnaire?</span>                            <div class="inner_title fright">                                <div class="onoffswitch1">                                    <input type="checkbox" name="tap_switch" class="onoffswitch-checkbox" id="tab3" <?php echo $re_tap_active; ?>>                                    <label class="onoffswitch-label" for="tab3"> <span class="onoffswitch-inner onoffswitch-inner1"></span> <span class="onoffswitch-switch onoffswitch-switch1"></span> </label>                                </div>                            </div>                        </div>                    </div>                </div>                <div class="lastouter_sec1">                    <input type="hidden" name="submitted" value="1" />                    <button class="butt_view bb_sec6" id="saveandnext"> Save&Next </button>                    <button class="butt_view bb_sec6"> Save&Exit </button>                    <button class="butt_view bb_sec6 bb_bg"> Cancel </button>                </div>                <div class="clear"> </div>              </div><!--container-->        </form>    </div><!--wrapper--></section><!-- jQuery if needed --> <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js"></script> <script type="text/javascript">    function DropDown(el) {        this.dd = el;        this.placeholder = this.dd.children('span');        this.opts = this.dd.find('ul.dropdown > li');        this.val = '';        this.index = -1;        this.initEvents();    }    DropDown.prototype = {        initEvents: function() {            var obj = this;            obj.dd.on('click', function(event) {                $(this).toggleClass('active');                return false;            });            obj.opts.on('click', function() {                var opt = $(this);                obj.val = opt.text();                obj.index = opt.index();                obj.placeholder.text(obj.val);            });        },        getValue: function() {            return this.val;        },        getIndex: function() {            return this.index;        }    }    $(function() {        var dd = new DropDown($('#dd'));        $(document).click(function() {            // all dropdowns            $('.wrapper-dropdown-3').removeClass('active');        });    });</script><script type="text/javascript">    function DropDown(el) {        this.dd1 = el;        this.placeholder = this.dd1.children('span');        this.opts = this.dd1.find('ul.dropdown > li');        this.val = '';        this.index = -1;        this.initEvents();    }    DropDown.prototype = {        initEvents: function() {            var obj = this;            obj.dd1.on('click', function(event) {                $(this).toggleClass('active');                return false;            });            obj.opts.on('click', function() {                var opt = $(this);                obj.val = opt.text();                obj.index = opt.index();                obj.placeholder.text(obj.val);            });        },        getValue: function() {            return this.val;        },        getIndex: function() {            return this.index;        }    }    $(function() {        var dd1 = new DropDown($('#dd1'));        $(document).click(function() {            // all dropdowns            $('.wrapper-dropdown-3').removeClass('active');        });    });</script>   <!--     <script type="text/javascript" src="jquery/jquery-1.9.1.js"></script>--><script type="text/javascript" src="jquery/spectrum.js"></script><script type='text/javascript' src="jquery/docs.js"></script></body></html>