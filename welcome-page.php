<?php include 'header.php';include 'check_session.php';//function __autoload($classname) {//    include "./API/include/" . $classname . ".class.php";//}if(!isset($_GET['ques_id'])) {    echo '<h1>Invalid Access !!</h1>';    echo '<script>location.href = "admin.php";</script>';    exit();} else {    include "./API/include/Connection.class.php";    include "./API/include/Quest.class.php";    $questObj = new Quest();    $ques_id = $_GET['ques_id'];    $bool = $questObj->isValidQuesID($ques_id);    if($bool) {        echo '<h1>Invalid Question ID passed !!</h1>';        exit();    }        if(isset($_POST['submitted'])) {        $is_welcome = isset($_POST['iswelcome'])?"0":"1";        $setting_id = 3;                $insertSettingBool = $questObj->checkQuesSetting($ques_id, $setting_id);        if($insertSettingBool) {            $questObj->insertQuesSetting($ques_id, $setting_id, $is_welcome);        } else {            $questObj->updateQuesSetting($ques_id, $setting_id, $is_welcome);        }        if($is_welcome == "1") {                $header_image = isset($_FILES['headerimage'])?$_FILES['headerimage']:array();                $ques_title = isset($_POST['ques_title'])?$_POST['ques_title']:"";                $title_size = isset($_POST['title_size_hidden'])?$_POST['title_size_hidden']:"";                $title_font = isset($_POST['title_font_hidden'])?$_POST['title_font_hidden']:"";                        $title_color = isset($_POST['title_color'])?$_POST['title_color']:"";                $ques_text = isset($_POST['ques_text'])?$_POST['ques_text']:"";                $text_size = isset($_POST['text_size'])?$_POST['text_size']:"";                $text_font = isset($_POST['text_font'])?$_POST['text_font']:"";                        $text_color = isset($_POST['text_color'])?$_POST['text_color']:"";                $background_image = isset($_FILES['bgimage'])?$_FILES['bgimage']:array();                $bg_color = isset($_POST['bgcolor'])?$_POST['bgcolor']:"";                $btn_text = isset($_POST['btn_text'])?$_POST['btn_text']:"";                $btn_size = isset($_POST['btn_size'])?$_POST['btn_size']:"";                        $btn_color = isset($_POST['btn_color'])?$_POST['btn_color']:"";                $btn_switch = isset($_POST['btn_switch'])?"1":"0";                $tap_switch = isset($_POST['tap_switch'])?"1":"0";                $element_type = array();                $element_type[] = 'Header Image';                $element_type[] = 'Title';                $element_type[] = 'Text';                $element_type[] = 'Background Image';                $element_type[] = 'Button';                $element_type[] = 'Tap';                $element_name = array();                        $element_name[] = '';                $element_name[] = $ques_title;                $element_name[] = $ques_text;                $element_name[] = '';                $element_name[] = $btn_text;                $element_name[] = '';                $element_size = array();                $element_size[] = '';                $element_size[] = $title_size;                $element_size[] = $text_size;                $element_size[] = '';                $element_size[] = $btn_size;                $element_size[] = '';                $element_font = array();                $element_font[] = '';                $element_font[] = $title_font;                $element_font[] = $text_font;                $element_font[] = '';                $element_font[] = '';                $element_font[] = '';                $element_color = array();                $element_color[] = '';                $element_color[] = $title_color;                $element_color[] = $text_color;                $element_color[] = $bg_color;                $element_color[] = $btn_color;                $element_color[] = '';                $element_attachment = array();                $element_attachment[] = $header_image;                $element_attachment[] = '';                $element_attachment[] = '';                $element_attachment[] = $background_image;                $element_attachment[] = '';                $element_attachment[] = '';                $active = array();                $active[] = '1';                $active[] = '1';                $active[] = '1';                $active[] = '1';                $active[] = $btn_switch;                $active[] = $tap_switch;                $count = count($element_type);                $access_token = $_SESSION['access_token'];                $insertElementBool = $questObj->checkQuesSettingElement($ques_id, $setting_id);                for($i=0;$i<$count;$i++) {                    if($element_attachment[$i] != '') {                        $file_name = $questObj->uploadFile($element_attachment[$i], $access_token);                    } else {                        $file_name = '';                    }                    if($insertElementBool) {                        $questObj->insertQuesElement($ques_id, $setting_id, $element_type[$i], $element_name[$i], $element_color[$i], $element_size[$i], $element_font[$i], $file_name, $active[$i]);                    } else {                        $questObj->updateQuesElement($ques_id, $setting_id, $element_type[$i], $element_name[$i], $element_color[$i], $element_size[$i], $element_font[$i], $file_name, $active[$i]);                    }                }        }        echo "<script>location.href = 'questionnaire_question.php?ques_id=$ques_id'; </script>";        exit();    }    }?><script>function readURL(input) {    if (input.files && input.files[0]) {        var reader = new FileReader();        reader.onload = function (e) {            $('#dispimg').attr('src', e.target.result);            $('#dispimg').show();        };        reader.readAsDataURL(input.files[0]);    }} function save(check)    {        // Flag to check if welcome page is selected        var is_welcome= $("input[name=iswelcome]").is(":checked");                //Settings for element type header image        var headerimage = $('#headerimage').val();                //Settings for element type title        var ques_title = $('#ques_title').val();        var title_size = $('#title_size').html();        $('#title_size_hidden').val(title_size);        var title_font = $("#title_font").html();        $('#title_font_hidden').val(title_font);        var title_color = $("#13").val();                //Settings for element type text        var ques_text = $('#ques_text').val();        var text_size = $('#text_size').val();        var text_font = $("#text_font").val();        var text_color = $("#14").val();                //Settings for element type background image        var bgimage = $('#bgimage').val();        var bg_color = $("#15").val();                //Settings for element type button        var btn_text = $('#btn_text').val();        var btn_size = $('#btn_size').val();        var btn_color = $("#16").val();        var btn_active = $("input[name=btn_switch]").is(":checked");                //Settings for element type tap        var tap_active = $("input[name=tap_switch]").is(":checked");                var element_type = new Array();        element_type.push('Header Photo');        element_type.push('Title');        element_type.push('Text');        element_type.push('Background Image');        element_type.push('Button');        element_type.push('Tap');                var element_name = new Array();        element_name.push('');        element_name.push(ques_title);        element_name.push(ques_text);        element_name.push('');        element_name.push(btn_text);        element_name.push('');                var element_size = new Array();        element_size.push('');        element_size.push(title_size);        element_size.push(text_size);        element_size.push('');        element_size.push(btn_size);        element_size.push('');                var element_font = new Array();        element_font.push('');        element_font.push(title_font);        element_font.push(text_font);        element_font.push('');        element_font.push('');        element_font.push('');        var element_color = new Array();        element_color.push('');        element_color.push(title_color);        element_color.push(text_color);        element_color.push(bg_color);        element_color.push(btn_color);        element_color.push('');                var element_attachment = new Array();        element_attachment.push(headerimage);        element_attachment.push('');        element_attachment.push('');        element_attachment.push(bgimage);        element_attachment.push('');        element_attachment.push('');                var element_active = new Array();        element_active.push(true);        element_active.push(true);        element_active.push(true);        element_active.push(true);        element_active.push(btn_active);        element_active.push(tap_active);    }$(document).ready(function(){    $("#headerbutt").click(function(){        $("#headerimage").click();	    });    $("#bgimagebutt").click(function(){        $("#bgimage").click();        event.preventDefault();    });    $("#headerimage").change(function(){        readURL(this);    });         $('#saveandnext').click(function(event){            event.preventDefault();            save("san");            $("#form").submit();        });            });</script><div class="sec_create">    <h2 class="sec_head_ques"> Create a Questionnaire</h2>  </div> <section>    <div class="wrapper">        <form action="#" id="form" method="post" enctype="multipart/form-data">    <div class="container ww">    <h2 class="wel_head"> Would you like a Welcome page</h2>    <div class="onoffswitch">    <input type="checkbox" name="iswelcome" class="onoffswitch-checkbox" id="taber" checked>    <label class="onoffswitch-label" for="taber"> <span class="onoffswitch-inner"></span> <span class="onoffswitch-switch"></span> </label>  </div>    <div class="show_toggle">    <div class="hide_toggle">    <div class="header_browse">        <!--<div class="browse">-->        <div>        <div class="photo_head">            <h3> Header Photo </h3>          </div>        <div class="button_browse">            <button class="bb_ques" id="headerbutt" type="button">Browse</button>            <input type="file" id="headerimage" name="headerimage" style="display:none;"/>            <img id="dispimg" src="#" alt="Header Image" style="display:none; max-height: 200px; max-width: 200px; margin-top: 10px;"/>          </div>                  </div>        <div class="outer_title1">        <div class="inner_title1 fleft">            <label>Title</label>            <br>            <input type="text" name="ques_title" id="ques_title" class="title_text title_text1">          </div>        <div class="inner_title1 fleft ">            <label>Title Size</label>            <br>            <div class="wrapper-demo">                <div id="dd" class="wrapper-dropdown-3" tabindex="1"> <span id="title_size">Select Size</span>                <input type="hidden" name="title_size_hidden" id="title_size_hidden" />                <ul class="dropdown">                <?php for($size=10; $size<30; $size++) { ?>                    <li><a href="#"><?php echo $size; ?></a></li>                <?php } ?>                              </ul>              </div>            ​</div>          </div>        <div class="inner_title1 fleft">            <label>Title Font</label>            <br>            <div class="wrapper-demo">                <div id="dd1" class="wrapper-dropdown-3" tabindex="1"> <span id="title_font">Select Font</span>                    <input type="hidden" name="title_font_hidden" id="title_font_hidden" />            <?php $font_array = ["Arial","Times New Roman","Sans-Serif"]; ?>                <ul class="dropdown">                <?php                  foreach($font_array as $font)                  {                  ?>                    <li><a href="#"><?php echo $font; ?></a></li>                <?php                                 }                  ?>              </ul>              </div>            ​</div>          </div>        <div class="inner_title1 fleft">            <label>Title Color</label>            <br>         <div class='example'>                  <input type='text' name='title_color' id='13' value='orangered' />                                </div>          </div>      </div>        <div class="clear"> </div>        <div class="outer_title1">        <div class="inner_title1 fleft">            <label>Text</label>            <br>            <textarea rows="5" cols="25" id="ques_text" name="ques_text"></textarea>          </div>        <div class="inner_title1 fleft ">            <label>Text Size</label>            <br>            <input type="number" id="text_size" name="text_size" class="title_size title_size1">          </div>        <div class="inner_title1 fleft">            <label>Text Font</label>            <br>            <input type="text" id="text_font" name="text_font" class="title_size title_size_font title_size1">          </div>        <div class="inner_title1 fleft">            <label>Text Color</label>            <br>             <div class='example'>                  <input type='text' name='text_color' id='14' value='orangered' />                                  </div>          </div>      </div>        <div class="clear"> </div>      </div>         <div class="outer_title1">        <div class="inner_title3 inner_title_ttl  fleft">            <label class="sec_head_ques1 "> Background-image </label>            <div class="sec_ques_div">            <input type="text" class="fleft" >            <button class="bb_ques fleft" id="bgimagebutt">Browse..</button>            <input type="file" name="bgimage" id="bgimage" style="display:none;"/>          </div>          </div>        <div class="inner_title3 inner_title_ttl fleft ">            <label>Background-color</label>            <br>             <div class='example'>                  <input type='text' name='bgcolor' id='15' value='orangered' />                                  </div>          </div>      </div>        <div class="clear"> </div>          <div class="outer_sec5">        <div class="outer_title1">        <div class="inner_title1 fleft">        <label> Button Text</label>        <br>        <input id="btn_text" name="btn_text" type="text">      </div>        <div class="inner_title3 fleft ">        <label>Button-color</label>        <br>         <div class='example'>                  <input type='text' name='btn_color' id='16' value='orangered' />                                  </div>      </div>        <div class="inner_title1 fleft ">        <label>Button Size</label>        <br>        <input type="number" id="btn_size" name="btn_size" class="title_size title_size1">      </div>        <div class="fleft">        <label>Show/Hide Button</label>        <br>        <div class="onoffswitch1">        <input type="checkbox" name="btn_switch" class="onoffswitch-checkbox" id="tab2" checked>        <label class="onoffswitch-label" for="tab2">        <span class="onoffswitch-inner onoffswitch-inner1"></span> <span class="onoffswitch-switch onoffswitch-switch1"></span></label>        </div>        <!--label class=" fright"> Show</label-->        </div>        </div>        <div class="clear"> </div>      </div>	    <div class="wel_lastpara"> <span class="wel_lastpara_span">Tap anywhere on screen to enter questionnaire?</span>        <div class="inner_title fright">        <div class="onoffswitch1">            <input type="checkbox" name="tap_switch" class="onoffswitch-checkbox" id="tab3" checked>            <label class="onoffswitch-label" for="tab3"> <span class="onoffswitch-inner onoffswitch-inner1"></span> <span class="onoffswitch-switch onoffswitch-switch1"></span> </label>          </div>           </div>      </div> </div>        </div>      <div class="lastouter_sec1">          <input type="hidden" name="submitted" value="1" />          <button class="butt_view bb_sec6" id="saveandnext"> Save&Next </button>        <button class="butt_view bb_sec6"> Save&Exit </button>        <button class="butt_view bb_sec6 bb_bg"> Cancel </button>      </div>       <div class="clear"> </div>        </div><!--container--></form>      </div><!--wrapper-->   </section>    <!-- jQuery if needed --> <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js"></script> <script type="text/javascript">						function DropDown(el) {				this.dd = el;				this.placeholder = this.dd.children('span');				this.opts = this.dd.find('ul.dropdown > li');				this.val = '';				this.index = -1;				this.initEvents();			}			DropDown.prototype = {				initEvents : function() {					var obj = this;					obj.dd.on('click', function(event){						$(this).toggleClass('active');						return false;					});					obj.opts.on('click',function(){						var opt = $(this);						obj.val = opt.text();						obj.index = opt.index();						obj.placeholder.text(obj.val);					});				},				getValue : function() {					return this.val;				},				getIndex : function() {					return this.index;				}			}			$(function() {				var dd = new DropDown( $('#dd') );				$(document).click(function() {					// all dropdowns					$('.wrapper-dropdown-3').removeClass('active');				});			});		</script>        <script type="text/javascript">						function DropDown(el) {				this.dd1 = el;				this.placeholder = this.dd1.children('span');				this.opts = this.dd1.find('ul.dropdown > li');				this.val = '';				this.index = -1;				this.initEvents();			}			DropDown.prototype = {				initEvents : function() {					var obj = this;					obj.dd1.on('click', function(event){						$(this).toggleClass('active');						return false;					});					obj.opts.on('click',function(){						var opt = $(this);						obj.val = opt.text();						obj.index = opt.index();						obj.placeholder.text(obj.val);					});				},				getValue : function() {					return this.val;				},				getIndex : function() {					return this.index;				}			}			$(function() {				var dd1 = new DropDown( $('#dd1') );				$(document).click(function() {					// all dropdowns					$('.wrapper-dropdown-3').removeClass('active');				});			});		</script>   <!--     <script type="text/javascript" src="jquery/jquery-1.9.1.js"></script>-->  <script type="text/javascript" src="jquery/spectrum.js"></script>  <script type='text/javascript' src="jquery/docs.js"></script></body></html>